<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Список страниц</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="../styles/shared.css">
</head>
<body class="list-page">
  <h1>Список страниц</h1>
  <div id="status">Загрузка списка...</div>
  <div id="list" class="list" aria-live="polite"></div>

<script>
(async function() {
  const statusEl = document.getElementById("status");
  const listEl = document.getElementById("list");

  try {
    const resp = await fetch("list.json");
    if (!resp.ok) throw new Error("Не удалось загрузить list.json");
    const items = await resp.json();

    if (!Array.isArray(items) || items.length === 0) {
      statusEl.textContent = "Здесь пока пусто :(";
      return;
    }

    // сортировка по названию (второй элемент)
    const parsedItems = items.map(str => {
      const [path, name] = str.split(",");
      return { path: path.trim(), name: (name || path).trim() };
    }).sort((a, b) => a.name.localeCompare(b.name, "ru"));

    statusEl.textContent = `Найдено ${parsedItems.length} страниц:`;

    parsedItems.forEach(({ path, name }) => {
      const a = document.createElement("a");
      a.className = "item";
      a.href = path;
      a.textContent = name;
      listEl.appendChild(a);
    });

  } catch (err) {
    statusEl.innerHTML = `<span class="error">Ошибка:</span> ${err.message}`;
    console.error(err);
  }
})();
</script>
</body>
</html>
